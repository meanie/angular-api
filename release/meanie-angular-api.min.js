/**
 * meanie-angular-api - v1.10.0 - 16-5-2016
 * https://github.com/meanie/angular-api
 *
 * Copyright (c) 2016 Adam Buczynski <me@adambuczynski.com>
 * License: MIT
 */
"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};!function(t,n,e){n.module("Api.Action.Service",["Url.Service"]).factory("$apiAction",["$q","$injector","$log","$url",function(t,e,r,i){function o(t){return t?e.has(t)?t:(r.warn("Unknown model class/service:",t),null):null}function s(t,e){n.extend(this,t),this.url=i.concat(e.url,this.url||""),this.model=this.model||e.model||!1,this.params=this.params||e.params||{},this.method=this.method||"GET",this.enforceDataFormat=e.enforceDataFormat||!1,this.model=o(this.model)}return s.prototype.hasBody=function(){return/^(POST|PUT|PATCH)$/i.test(this.method)},s.prototype.expectsArray=function(){return!!this.isArray},s.prototype.expectsModel=function(){return this.model&&!!this.isModel},s.prototype.convertToModel=function(t){if(n.isArray(t))return t.map(this.convertToModel.bind(this));var r=e.get(this.model);return new r(t)},s.prototype.successInterceptor=function(t){var e=this.expectsArray(),i=n.isArray(t.data);return i!==e&&(r.warn("Expected",e?"array":"object","as response, got",i?"array":_typeof(t.data)),this.enforceDataFormat&&(t.data=e?[]:{})),t.data||(e?[]:{})},s.prototype.errorInterceptor=function(n){return t.reject(n)},function(t,n){return new s(t,n)}}])}(window,window.angular),function(t,n,e){n.module("Api.Service",["Api.Endpoint.Service"]).provider("$api",function(){this.defaults={verbose:!1,enforceDataFormat:!1,baseUrl:"/",actions:{query:{method:"GET",isArray:!0,isModel:!0},get:{method:"GET",isModel:!0},create:{method:"POST"},update:{method:"PUT"},"delete":{method:"DELETE"}},params:{id:"@id"},model:"",stripTrailingSlashes:!0},this.endpoints={},this.setVerbose=function(t){return this.defaults.verbose=!!t,this},this.setBaseUrl=function(t){return this.defaults.baseUrl=t.replace(/:([0-9]+)/,"\\:$1"),this},this.setEnforceDataFormat=function(t){return this.defaults.enforceDataFormat=!!t,this},this.setDefaultActions=function(t){return this.defaults.actions=t||{},this},this.setDefaultParams=function(t){return this.defaults.params=t||{},this},this.setDefaultModel=function(t){return this.defaults.model=t||!1,this},this.setConfig=function(t,n){return this.defaults[t]=n,this},this.stripTrailingSlashes=function(t){return this.defaults.stripTrailingSlashes=!!t,this},this.registerEndpoint=function(t,n){return t&&(this.endpoints[t]=n||{}),this},this.$get=["$log","$apiEndpoint",function(t,e){var r=function(t){return this[t]};return n.forEach(this.endpoints,function(i,o){r[o]&&t.warn("API endpoint",o,"is being overwritten."),i=n.extend({},this.defaults,i),i.verbose&&t.info("API endpoint",o+":",i),r[o]=e(o,i)},this),r}]})}(window,window.angular);var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};!function(t,n,e){n.module("BaseModel.Service",[]).factory("$baseModel",["$window","$log","$injector",function(t,e,r){function i(t){var n=/(\d{4})-(\d{2})-(\d{2})T(\d{2})\:(\d{2})\:(\d{2}).*/;if(t.match(n)){var e=a(t,a.ISO_8601,!0);if(e.isValid())return e}return null}function o(t,e){if(n.isArray(t[e])){var r=function(){var n=t[e];return{v:n.map(function(t,e){return o(n,e)})}}();if("object"===("undefined"==typeof r?"undefined":_typeof(r)))return r.v}return t[e]&&n.isFunction(t[e].clone)?t[e].clone():n.copy(t[e])}function s(t){this.fromJSON(t)}var a=void 0;return r.has("moment")?a=r.get("moment"):"undefined"!=typeof t.moment&&(a=t.moment),s.prototype.convertToModel=function(t,i,o,a){if("boolean"==typeof i&&(o=i,i=null),"undefined"==typeof this[t]&&(o?this[t]=[]:this[t]=null),i&&(this[t]||!a)){if("string"==typeof i){if(!r.has(i))return e.warn("Unknown model",i,"specified for sub model conversion");i=r.get(i)}n.isArray(this[t])?this[t]=this[t].map(function(t){return new i(t)}):n.isString(this[t])&&s.isId(this[t])?this[t]=new i({id:this[t]}):this[t]=new i(this[t])}},s.prototype.fromJSON=function(t){var e=this;return n.isObject(t)&&n.forEach(t,function(t,n){e[n]=s.valueFromJSON(t)},this),this},s.prototype.toJSON=function(t){var e={};return t&&n.isObject(t)&&n.forEach(t,function(t,n){e[n]=s.valueToJSON(t)}),n.forEach(this,function(t,n){e.hasOwnProperty(n)||(e[n]=s.valueToJSON(t))}),e},s.prototype.extract=function(t){var e=this,r={};return n.isArray(t)&&t.length?n.forEach(t,function(t){r[t]=o(e,t)}):n.forEach(this,function(t,n){r[n]=o(e,n)}),r},s.prototype.merge=function(t){var e=this;t&&n.isObject(t)&&n.forEach(t,function(n,r){e[r]=o(t,r)})},s.prototype.clear=function(){for(var t in this)this.hasOwnProperty(t)&&delete this[t]},s.prototype.clone=function(t){var n=this.constructor,e=new n(this.extract());return e.id&&t&&delete e.id,e},s.prototype.copyProperty=function(t,e){n.isArray(this[e]),this[e]&&n.isFunction(this[e].clone)?t[e]=this[e].clone():t[e]=n.copy(this[e])},s.valueFromJSON=function(t){if(n.isArray(t))return t.map(s.valueFromJSON);if(a&&n.isString(t)){var e=i(t);return e||t}return n.copy(t)},s.valueToJSON=function(t){if(n.isArray(t))return t.map(s.valueToJSON);if(t&&n.isObject(t)){if(n.isFunction(t.toJSON))return t.toJSON();var e={};for(var r in t)t.hasOwnProperty(r)&&(e[r]=s.valueToJSON(t[r]));return e}return t},s.onlyId=function(t){return n.isArray(t)?t.map(s.onlyId):t&&"object"===("undefined"==typeof t?"undefined":_typeof(t))&&t.id?t.id:t},s.isId=function(t){return t.match(/^[a-f\d]{24}$/i)},s}])}(window,window.angular),function(t,n,e){n.module("Api.Endpoint.Service",["Api.Action.Service","Api.Request.Service","Url.Service"]).factory("$apiEndpoint",["$url","$apiAction","$apiRequest",function(t,e,r){function i(i,o){o.url=t.concat(o.baseUrl,o.url||t.concat(i,":id")),o.actions=o.actions||{},this.$config=o,this.$actions={},n.forEach(o.actions,function(t,i){this.$actions[i]=e(t||{},o),this[i]=n.bind(this,r,this.$actions[i])},this)}return function(t,n){return new i(t,n)}}])}(window,window.angular),function(t,n,e){n.module("Api.Request.Service",["Url.Service"]).factory("$apiRequest",["$http","$url",function(t,r){function i(t){return t&&"hasOwnProperty"!==t&&/^(\.[a-zA-Z_$@][0-9a-zA-Z_$@]*)+$/.test("."+t)}function o(t,n){if(!i(n))throw new Error("Invalid dotted path:"+n);for(var r=n.split("."),o=0;o<r.length&&t!==e;o++){var s=r[o];t=null!==t?t[s]:e}return t}function s(t,e,r){var i={};return n.forEach(t||{},function(t,e){n.isFunction(t)&&(t=t()),n.isString(t)&&"@"===t.charAt(0)&&(t=o(r,t.substr(1))),i[e]=t}),n.extend(i,e||{})}function a(t){var e={};return n.forEach(t.split(/\W/),function(n){if("hasOwnProperty"===n)throw new Error("Invalid parameter name: hasOwnProperty");n&&!/^\\d+$/.test(n)&&new RegExp("(^|[^\\\\]):"+n+"(\\W|$)").test(t)&&(e[n]=!0)}),e}function u(t,n){return n&&(t=t.replace(/\/+$/,"")||"/"),t.replace(/\/\.(?=\w+($|\?))/,".").replace(/\/\\\./,"/.")}function c(t,e,i,o){return t=t.replace(/\\:/g,":"),n.forEach(i,function(i,o){var s,a=e.hasOwnProperty(o)?e[o]:null;if(n.isDefined(a)&&null!==a){var u=r.encodeUriSegment(a);s=new RegExp(":"+o+"(\\W|$)","g"),t=t.replace(s,function(t,n){return u+n})}else s=new RegExp("(/?):"+o+"(\\W|$)","g"),t=t.replace(s,function(t,n,e){return"/"===e.charAt(0)?e:n+e})}),u(t,o)}function f(t,e,r){var i={},o=["params","model","isArray","isModel","successInterceptor","errorInterceptor","stripTrailingSlashes"];if(n.forEach(t,function(t,e){-1===o.indexOf(e)&&(i[e]=n.copy(t))}),t.hasBody()&&r&&n.isObject(r)&&(n.isFunction(r.toJSON)?i.data=r.toJSON():n.isArray(r)?i.data=r:i.data=n.extend({},r)),e&&n.isObject(e))for(var u in e)e.hasOwnProperty(u)&&n.isObject(e[u])&&n.isFunction(e[u].toJSON)&&(e[u]=e[u].toJSON());e=s(t.params,e,r);var f=a(i.url);return i.url=c(t.url,e,f,t.stripTrailingSlashes),n.forEach(e,function(t,n){f[n]||(i.params=i.params||{},i.params[n]=t)}),i}return function(n,e,r){n.hasBody()&&e&&!r&&(r=e,e=null);var i=f(n,e,r),o=t(i).then(n.successInterceptor.bind(n),n.errorInterceptor.bind(n));return o.then(function(t){return n.expectsModel()?n.convertToModel(t):t})}}])}(window,window.angular);
//# sourceMappingURL=meanie-angular-api.min.js.map
