/**
 * meanie-angular-api - v0.4.1 - 17-6-2015
 * https://github.com/meanie/angular-api
 *
 * Copyright (c) 2015 Adam Buczynski <me@adambuczynski.com>
 * License: MIT
 */
!function(t,n,r){"use strict";n.module("Api.Action.Service",["Url.Service"]).factory("$apiAction",["$q","$injector","$log","$url",function(t,r,e,i){function o(t){return t?r.has(t)?t:(e.warn("Unknown model class/service:",t),null):null}function s(t,r){n.extend(this,t),this.url=i.concat(r.url,this.url||""),this.model=this.model||r.model||!1,this.method=this.method||"GET",this.model=o(this.model)}return s.prototype.hasBody=function(){return/^(POST|PUT|PATCH)$/i.test(this.method)},s.prototype.expectsArray=function(){return!!this.isArray},s.prototype.convertToModel=function(t){if(n.isArray(t))return t.map(function(t){return this.convertToModel(t)},this);var e=r.get(this.model);return new e(t)},s.prototype.successInterceptor=function(t){var r=this.expectsArray();return n.isArray(t.data)!==r&&e.warn("Expected",r?"array":"object","as response, got",t.data),t.data||(r?[]:{})},s.prototype.errorInterceptor=function(n){return t.reject(n)},function(t,n){return new s(t,n)}}])}(window,window.angular),function(t,n,r){"use strict";n.module("Api.Model",[]).factory("$apiModel",function(){function t(t){this.fromJSON(t)}return t.prototype.init=function(){n.forEach(this,function(t,n){delete this[n]},this)},t.prototype.fromJSON=function(t){return this.init(),n.isObject(t)?(n.forEach(t,function(t,n){this[n]=t},this),this):this},t.prototype.toJSON=function(){var t=n.extend({},this);return t},t})}(window,window.angular),function(t,n,r){"use strict";n.module("Api.Service",["Api.Endpoint.Service","Api.Model"]).provider("$api",function(){this.defaults={baseUrl:"/",actions:{query:{method:"GET",isArray:!0},get:{method:"GET"},create:{method:"POST"},update:{method:"PUT"},destroy:{method:"DELETE"}},params:{id:"@id"},model:"$apiModel",stripTrailingSlashes:!0},this.endpoints={},this.setBaseUrl=function(t){return this.defaults.baseUrl=t,this},this.setDefaultActions=function(t){return this.defaults.actions=t||{},this},this.setDefaultParams=function(t){return this.defaults.params=t||{},this},this.setDefaultModel=function(t){return this.defaults.model=t||!1,this},this.stripTrailingSlashes=function(t){return this.defaults.stripTrailingSlashes=!!t,this},this.registerEndpoint=function(t,n){return t&&(this.endpoints[t]=n||{}),this},this.$get=["$injector","$log","$apiEndpoint",function(t,r,e){var i=function(t){return this[t]};return n.forEach(this.endpoints,function(t,o){i[o]&&r.warn("API endpoint",o,"is being overwritten."),t=n.extend({},this.defaults,t),i[o]=e(o,t)},this),i}]})}(window,window.angular),function(t,n,r){"use strict";n.module("Api.Endpoint.Service",["Api.Action.Service","Api.Request.Service","Url.Service"]).factory("$apiEndpoint",["$url","$apiAction","$apiRequest",function(t,r,e){function i(i,o){o.url=t.concat(o.baseUrl,o.url||t.concat(i,":id")),o.actions=o.actions||{},this.$config=o,this.$actions={},n.forEach(o.actions,function(t,i){this.$actions[i]=r(t||{},o),this[i]=n.bind(this,e,this.$actions[i])},this)}return function(t,n){return new i(t,n)}}])}(window,window.angular),function(t,n,r){"use strict";n.module("Api.Request.Service",["Url.Service"]).factory("$apiRequest",["$http","$url",function(t,e){function i(t){return n.isObject(t)&&n.isFunction(t.toJSON)}function o(t){return t&&"hasOwnProperty"!==t&&/^(\.[a-zA-Z_$@][0-9a-zA-Z_$@]*)+$/.test("."+t)}function s(t,n){if(!o(n))throw new Error("Invalid dotted path:"+n);for(var e=n.split("."),i=0;i<e.length&&t!==r;i++){var s=e[i];t=null!==t?t[s]:r}return t}function a(t,r,e){var i={};return n.forEach(t||{},function(t,r){n.isFunction(t)&&(t=t()),n.isString(t)&&"@"===t.charAt(0)&&(t=s(e,t.substr(1))),i[r]=t}),n.extend(i,r||{})}function u(t){var r={};return n.forEach(t.split(/\W/),function(n){if("hasOwnProperty"===n)throw new Error("Invalid parameter name: hasOwnProperty");n&&!/^\\d+$/.test(n)&&new RegExp("(^|[^\\\\]):"+n+"(\\W|$)").test(t)&&(r[n]=!0)}),r}function c(t,n){return n&&(t=t.replace(/\/+$/,"")||"/"),t.replace(/\/\.(?=\w+($|\?))/,".").replace(/\/\\\./,"/.")}function h(t,r,i,o){return t=t.replace(/\\:/g,":"),n.forEach(i,function(i,o){var s,a=r.hasOwnProperty(o)?r[o]:null;if(n.isDefined(a)&&null!==a){var u=e.encodeUriSegment(a);s=new RegExp(":"+o+"(\\W|$)","g"),t=t.replace(s,function(t,n){return u+n})}else s=new RegExp("(/?):"+o+"(\\W|$)","g"),t=t.replace(s,function(t,n,r){return"/"===r.charAt(0)?r:n+r})}),c(t,o)}function l(t,r,e){var o={},s=["params","model","isArray","stripTrailingSlashes","successInterceptor","errorInterceptor"];n.forEach(t,function(t,r){-1===s.indexOf(r)&&(o[r]=n.copy(t))}),t.hasBody()&&e&&(i(e)&&(e=e.toJSON()),o.data=e),r=a(t.params,r,e);var c=u(o.url);return o.url=h(t.url,r,c,t.stripTrailingSlashes),n.forEach(r,function(t,n){c[n]||(o.params=o.params||{},o.params[n]=t)}),o}return function(n,r,e){n.hasBody()&&r&&!e&&(e=r,r=null);var o=l(n,r,e),s=n.model&&/^(GET|POST|PUT|PATCH)$/i.test(n.method),a=t(o).then(n.successInterceptor.bind(n),n.errorInterceptor.bind(n));return a.then(function(t){return n.hasBody()&&i(e)?e.fromJSON(t):s?n.convertToModel(t):t})}}])}(window,window.angular);
//# sourceMappingURL=meanie-angular-api.min.js.map