/**
 * meanie-angular-api - v1.5.3 - 13-4-2016
 * https://github.com/meanie/angular-api
 *
 * Copyright (c) 2016 Adam Buczynski <me@adambuczynski.com>
 * License: MIT
 */
"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};!function(t,e,n){e.module("Api.Action.Service",["Url.Service"]).factory("$apiAction",["$q","$injector","$log","$url",function(t,n,r,o){function i(t){return t?n.has(t)?t:(r.warn("Unknown model class/service:",t),null):null}function s(t,n){e.extend(this,t),this.url=o.concat(n.url,this.url||""),this.model=this.model||n.model||!1,this.params=this.params||n.params||{},this.method=this.method||"GET",this.enforceDataFormat=n.enforceDataFormat||!1,this.model=i(this.model)}return s.prototype.hasBody=function(){return/^(POST|PUT|PATCH)$/i.test(this.method)},s.prototype.expectsArray=function(){return!!this.isArray},s.prototype.expectsModel=function(){return this.model&&!!this.isModel},s.prototype.convertToModel=function(t){if(e.isArray(t))return t.map(this.convertToModel.bind(this));var r=n.get(this.model);return new r(t)},s.prototype.successInterceptor=function(t){var n=this.expectsArray(),o=e.isArray(t.data);return o!==n&&(r.warn("Expected",n?"array":"object","as response, got",o?"array":_typeof(t.data)),this.enforceDataFormat&&(t.data=n?[]:{})),t.data||(n?[]:{})},s.prototype.errorInterceptor=function(e){return t.reject(e)},function(t,e){return new s(t,e)}}])}(window,window.angular),function(t,e,n){e.module("Api.Service",["Api.Endpoint.Service"]).provider("$api",function(){this.defaults={verbose:!1,enforceDataFormat:!1,baseUrl:"/",actions:{query:{method:"GET",isArray:!0,isModel:!0},get:{method:"GET",isModel:!0},create:{method:"POST"},update:{method:"PUT"},"delete":{method:"DELETE"}},params:{id:"@id"},model:"",stripTrailingSlashes:!0},this.endpoints={},this.setVerbose=function(t){return this.defaults.verbose=!!t,this},this.setBaseUrl=function(t){return this.defaults.baseUrl=t.replace(/:([0-9]+)/,"\\:$1"),this},this.setEnforceDataFormat=function(t){return this.defaults.enforceDataFormat=!!t,this},this.setDefaultActions=function(t){return this.defaults.actions=t||{},this},this.setDefaultParams=function(t){return this.defaults.params=t||{},this},this.setDefaultModel=function(t){return this.defaults.model=t||!1,this},this.setConfig=function(t,e){return this.defaults[t]=e,this},this.stripTrailingSlashes=function(t){return this.defaults.stripTrailingSlashes=!!t,this},this.registerEndpoint=function(t,e){return t&&(this.endpoints[t]=e||{}),this},this.$get=["$log","$apiEndpoint",function(t,n){var r=function(t){return this[t]};return e.forEach(this.endpoints,function(o,i){r[i]&&t.warn("API endpoint",i,"is being overwritten."),o=e.extend({},this.defaults,o),o.verbose&&t.info("API endpoint",i+":",o),r[i]=n(i,o)},this),r}]})}(window,window.angular);var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};!function(t,e,n){e.module("BaseModel.Service",[]).factory("$baseModel",["$window","$log","$injector",function(t,n,r){function o(t){var e=/(\d{4})-(\d{2})-(\d{2})T(\d{2})\:(\d{2})\:(\d{2}).*/;if(t.match(e)){var n=s(t,s.ISO_8601,!0);if(n.isValid())return n}return null}function i(t){this.fromJSON(t)}var s=void 0;return r.has("moment")?s=r.get("moment"):"undefined"!=typeof t.moment&&(s=t.moment),i.prototype.convertToModel=function(t,o,i){if("boolean"==typeof o&&(i=o,o=null),"undefined"==typeof this[t]&&(i?this[t]=[]:this[t]=null),o){if("string"==typeof o){if(!r.has(o))return n.warn("Unknown model",o,"specified for sub model conversion");o=r.get(o)}e.isArray(this[t])?this[t]=this[t].map(function(t){return new o(t)}):this[t]=new o(this[t])}},i.prototype.fromJSON=function(t){var n=this;return e.isObject(t)&&e.forEach(t,function(t,e){n[e]=i.valueFromJSON(t)},this),this},i.prototype.toJSON=function(t){var n={};return t&&e.isObject(t)&&e.forEach(t,function(t,e){n[e]=i.valueToJSON(t)}),e.forEach(this,function(t,e){n.hasOwnProperty(e)||(n[e]=i.valueToJSON(t))}),n},i.prototype.extract=function(t){var n={},r=e.isArray(t)&&t.length;return e.forEach(this,function(o,i){(!r||t.indexOf(i)>=0)&&(n[i]=e.copy(o))}),n},i.prototype.merge=function(t){var n=this;t&&e.isObject(t)&&e.forEach(t,function(t,r){n[r]=e.copy(t)})},i.prototype.clear=function(){for(var t in this)this.hasOwnProperty(t)&&delete this[t]},i.prototype.clone=function(){var t=this.constructor;return new t(this.extract())},i.valueFromJSON=function(t){if(e.isArray(t))return t.map(i.valueFromJSON);if(s&&e.isString(t)){var n=o(t);return n||t}return e.copy(t)},i.valueToJSON=function(t){if(e.isArray(t))return t.map(i.valueToJSON);if(t&&e.isObject(t)){if(e.isFunction(t.toJSON))return t.toJSON();var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=i.valueToJSON(t[r]));return n}return t},i.onlyId=function(t){return e.isArray(t)?t.map(i.onlyId):t&&"object"===("undefined"==typeof t?"undefined":_typeof(t))&&t.id?t.id:t},i}])}(window,window.angular),function(t,e,n){e.module("Api.Endpoint.Service",["Api.Action.Service","Api.Request.Service","Url.Service"]).factory("$apiEndpoint",["$url","$apiAction","$apiRequest",function(t,n,r){function o(o,i){i.url=t.concat(i.baseUrl,i.url||t.concat(o,":id")),i.actions=i.actions||{},this.$config=i,this.$actions={},e.forEach(i.actions,function(t,o){this.$actions[o]=n(t||{},i),this[o]=e.bind(this,r,this.$actions[o])},this)}return function(t,e){return new o(t,e)}}])}(window,window.angular),function(t,e,n){e.module("Api.Request.Service",["Url.Service"]).factory("$apiRequest",["$http","$url",function(t,r){function o(t){return t&&"hasOwnProperty"!==t&&/^(\.[a-zA-Z_$@][0-9a-zA-Z_$@]*)+$/.test("."+t)}function i(t,e){if(!o(e))throw new Error("Invalid dotted path:"+e);for(var r=e.split("."),i=0;i<r.length&&t!==n;i++){var s=r[i];t=null!==t?t[s]:n}return t}function s(t,n,r){var o={};return e.forEach(t||{},function(t,n){e.isFunction(t)&&(t=t()),e.isString(t)&&"@"===t.charAt(0)&&(t=i(r,t.substr(1))),o[n]=t}),e.extend(o,n||{})}function a(t){var n={};return e.forEach(t.split(/\W/),function(e){if("hasOwnProperty"===e)throw new Error("Invalid parameter name: hasOwnProperty");e&&!/^\\d+$/.test(e)&&new RegExp("(^|[^\\\\]):"+e+"(\\W|$)").test(t)&&(n[e]=!0)}),n}function u(t,e){return e&&(t=t.replace(/\/+$/,"")||"/"),t.replace(/\/\.(?=\w+($|\?))/,".").replace(/\/\\\./,"/.")}function c(t,n,o,i){return t=t.replace(/\\:/g,":"),e.forEach(o,function(o,i){var s,a=n.hasOwnProperty(i)?n[i]:null;if(e.isDefined(a)&&null!==a){var u=r.encodeUriSegment(a);s=new RegExp(":"+i+"(\\W|$)","g"),t=t.replace(s,function(t,e){return u+e})}else s=new RegExp("(/?):"+i+"(\\W|$)","g"),t=t.replace(s,function(t,e,n){return"/"===n.charAt(0)?n:e+n})}),u(t,i)}function f(t,n,r){var o={},i=["params","model","isArray","isModel","successInterceptor","errorInterceptor","stripTrailingSlashes"];e.forEach(t,function(t,n){-1===i.indexOf(n)&&(o[n]=e.copy(t))}),t.hasBody()&&r&&e.isObject(r)&&(e.isFunction(r.toJson)?o.data=r.toJson():e.isFunction(r.toObject)?(console.warn("Using `toObject` for model to JSON conversion is deprecated.\n","Please provide a `toJSON` method on your model instead."),o.data=r.toObject()):e.isArray(r)?o.data=r:o.data=e.extend({},r)),n=s(t.params,n,r);var u=a(o.url);return o.url=c(t.url,n,u,t.stripTrailingSlashes),e.forEach(n,function(t,e){u[e]||(o.params=o.params||{},o.params[e]=t)}),o}return function(e,n,r){e.hasBody()&&n&&!r&&(r=n,n=null);var o=f(e,n,r),i=t(o).then(e.successInterceptor.bind(e),e.errorInterceptor.bind(e));return i.then(function(t){return e.expectsModel()?e.convertToModel(t):t})}}])}(window,window.angular);
//# sourceMappingURL=meanie-angular-api.min.js.map
